```{r}
library(tidyverse)
library(tidycensus)
library(sf)
library(pals)
library(biscale)
library(ggrepel)
library(tigris)
options(tigris_use_cache = T)
library(ggnewscale)
library(cowplot)
library(lubridate)
library(slider)
library(hrbrthemes)
library(readxl)
library(scales)
library(RColorBrewer)
library(patchwork)
install.packages(usmap)
library(usmap)

```


```{r, cache=TRU}

cd118 <- congressional_districts(cb = TRUE, resolution = '20m', year = 2022)
```

```{r}
library(readr)
USA_118th_Congressional_Districts_7321755402533503133 <- read_csv("USA_118th_Congressional_Districts_-7321755402533503133.csv")
View(USA_118th_Congressional_Districts_7321755402533503133)
```
```{r}
#| label: load dems and change column

library(readxl)
T1_ag_dems <- read_excel("T1 ag dems.xlsx")
View(T1_ag_dems)


colnames(T1_ag_dems)[2] <- "Last Name"


view(T1_ag_dems)

```

```{r}
#| label: narrowing the data

dem_districts <- T1_ag_dems |>
  inner_join(USA_118th_Congressional_Districts_7321755402533503133, by = "Last Name")

dem_districts <- dem_districts |>
  filter(!(`District ID` %in% c("1308",
         "5103",
         "1707",
         "1707",
         "4813",
         "3708")))

colnames(dem_districts)[5] <- "GEOID"
```

```{r}
#| label: final data frame

cd118_join <- cd118 |>
  inner_join(dem_districts, by = "GEOID")

```

```{r}
#| label: neccesarry for maps

USA <- counties(state = NULL, cb = FALSE, resolution = "500k", year = NULL)


USA <- USA |>
  filter(!(STATEFP %in% c("60", "66", "78", "72", "69", "02", "15")))


USA_bounds <- st_bbox(USA)
```


```{r}
#| label: full country


ggplot() +
  geom_sf(data = USA) +
  geom_sf(data = cd118_join, fill = "red") +
  theme_minimal() +
  lims(
    x = c(USA_bounds$xmin, USA_bounds$xmax),
    y = c(USA_bounds$ymin, USA_bounds$ymax)) 
```
```{r}
#| label: CT Map

ggplot() +
  geom_sf(data = USA |>
            filter(STATEFP == "09")) +
  geom_sf(data = cd118_join |>
            filter(STATEFP == "09"), linewidth = 2) +
  theme_minimal()

```
```{r}
ggplot() +
  geom_sf(data = USA |>
            filter(STATEFP == "53")) +
  geom_sf(data = cd118_join |>
            filter(STATEFP == "53"), fill = "red", linewidth = 2) +
  theme_minimal()
```

